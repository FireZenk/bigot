(function(){var a,b,c,d,e,f,g,h,i,j=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=require("underscore"),a=require("fs"),d=Array.isArray||function(a){return toString.call("[object Array]"===a)},g=function(a){return a===Object(a)},f=function(a){return"function"==typeof a},h=function(a){return"string"==typeof a},i=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},e=function(a){var b,c;return null===a||i(a)?!1:1===a.nodeType&&b?!0:h(a||d(a||0===b||"number"==typeof b&&b>0&&(c=b-1,j.call(a,c)>=0)))},c=new RegExp("{comment [^}]+}","g"),exports.render=function(e,f){var h,i,j,k,l,m;return i=function(a){return a.replace(c,"")},l=function(b,c,d){var e;return e=a.readFileSync(c,"utf-8"),b.replace("{include "+d+"}",e)},k=function(a,b,c){var d,e,g,h;return h=a.indexOf("{"+c+" "),g=a.substring(h,a.length),d=g.indexOf("}"),e=g.substring(("{"+c+" ").length,d),a.replace("{"+c+" "+e+"}",b.call(f[""+e]))},j=function(a,b,c){var d,e;return b.call()?(a=a.replace("{if "+c+"}",""),e=a.lastIndexOf("{else}"),d=a.indexOf("{end "+c+"}")+6+(""+c).length,a=a.replace(a.slice(e,d),"")):(e=a.indexOf("{if "+c+"}"),d=a.lastIndexOf("{else}")+6,a=a.replace(a.slice(e,d),""),a=a.replace("{end "+c+"}",""))},m=function(a,c,e){var f,i,j,k,l,m,n;return m=a.indexOf("{loop "+e+"}"),void 0!==m?(n=7+m+(""+e).length,f=a.indexOf("{end "+e+"}"),i=a.slice(n,f),j="",b.each(c,function(a){var c;return g(a)?(c=i,b.each(a,function(b,e){var f,g,j;return d(b)?(j=c.indexOf("{loop "+e+"}"),f=6+c.indexOf("{end "+e+"}")+(""+e).length,g=h(c.slice(j,f),a),c=c.slice(0,j)+g+c.slice(f,i.length)):c=c.replace("{"+e+"}",b)}),j+=c):j+=i.replace("{@}",a)}),k=a.slice(f,a.length),l=a.slice(0,m),l+j+k.replace("{end "+e+"}","")):void 0},(h=function(a,e){return b.each(e,function(b,e){return c.test(a)&&(a=i(a)),a=-1!==a.indexOf("{include "+e+"}")?l(a,b,e):-1!==a.indexOf("{"+e+" ")?k(a,b,e):-1!==a.indexOf("{if "+e+"}")?j(a,b,e):d(b)?m(a,b,e):a.replace("{"+e+"}",b)}),a})(e,f)}}).call(this);